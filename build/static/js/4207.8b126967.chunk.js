"use strict";(self.webpackChunkmardoll_admin=self.webpackChunkmardoll_admin||[]).push([[4207],{10049:function(e,n,t){var r=t(1413),i=t(44925),l=t(93296),a=t(41932),o=t(2641),u=(t(72791),t(80184)),c=["children","override"],d=l.Z.useToken;n.Z=function(e){var n=e.children,t=e.override,l=(0,i.Z)(e,c),s=d().token,h=(null===s||void 0===s?void 0:s[t])||t,f={token:(0,r.Z)((0,r.Z)({},s),{},{colorPrimary:h,colorPrimaryHover:h,colorPrimaryBorderHover:h,colorPrimaryTextHover:h})};return(0,u.jsx)(a.ZP,{theme:f,children:(0,u.jsx)(o.ZP,(0,r.Z)((0,r.Z)({},l),{},{children:n}))})}},47701:function(e,n,t){t.d(n,{x:function(){return c}});var r=t(1413),i=t(44925),l=(t(72791),t(93070)),a=t(61134),o=t(80184),u=["children","control","name","help","hasFeedback"],c=function(e){var n,t,c=e.children,d=e.control,s=e.name,h=e.help,f=e.hasFeedback,v=void 0!==f&&f,p=(0,i.Z)(e,u),m=(0,a.bc)({name:s,control:d}),g=m.field,Z=m.fieldState,x=m.formState.errors;return(0,o.jsx)(l.Z.Item,(0,r.Z)((0,r.Z)({hasFeedback:v,name:s,normalize:function(e){return g.onChange(e),e},validateStatus:Z.invalid?"error":void 0,help:null!==(n=null===(t=x[s])||void 0===t?void 0:t.message)&&void 0!==n?n:h},p),{},{children:c}))}},12535:function(e,n,t){t.d(n,{Z:function(){return k}});var r=t(1413),i=t(74165),l=t(15861),a=t(29439),o=t(72791),u=t(72351),c=t(44695),d=t(93070),s=t(4206),h=t(71439),f=t(2641),v=t(86005),p=t(30276),m=t(763),g=t(61134),Z=t(54261),x=t(8007),y=t(47701),j=t(54174),w=t(80184),b=x.Ry({title:x.Z_().required("Vui l\xf2ng nh\u1eadp ti\xeau \u0111\u1ec1 d\u1ecbch v\u1ee5!"),description:x.Z_().required("Vui l\xf2ng nh\u1eadp n\u1ed9i dung d\u1ecbch v\u1ee5!"),url:x.nK().required("Vui l\xf2ng upload file h\xecnh \u1ea3nh").test("fileEmpty","Vui l\xf2ng upload file h\xecnh \u1ea3nh",(function(e){return 0!==(null===e||void 0===e?void 0:e.length)}))}).required();function k(e){var n=e.data,t=e.file,x=e.handleCancel,k=e.handleUpdateItem,C=(0,m.find)(n,{id:null===t||void 0===t?void 0:t.id})||{},F={id:(0,Z.Z)(),uid:(0,Z.Z)(),status:"done",url:(null===C||void 0===C?void 0:C.url)||"",name:(null===C||void 0===C?void 0:C.name)||"",alt:(null===C||void 0===C?void 0:C.alt)||""},N=(0,o.useRef)(null),S=d.Z.useForm(),I=(0,a.Z)(S,1)[0],P=s.ZP.useMessage(),V=(0,a.Z)(P,2),E=V[0],R=V[1],T=(0,o.useState)(!1),U=(0,a.Z)(T,2),q=U[0],D=U[1],L=(0,o.useState)([F]),B=(0,a.Z)(L,2),O=B[0],W=B[1],H={title:(null===C||void 0===C?void 0:C.title)||"",description:(null===C||void 0===C?void 0:C.description)||"",url:[F]},J=(0,g.cI)({defaultValues:H,resolver:(0,c.X)(b)}),_=J.control,z=J.handleSubmit,Q=J.formState.errors,M=J.reset,X=J.setValue;(0,o.useEffect)((function(){I.setFieldsValue({title:(null===C||void 0===C?void 0:C.title)||"",description:(null===C||void 0===C?void 0:C.description)||"",url:[F]}),X("title",(null===C||void 0===C?void 0:C.title)||""),X("description",(null===C||void 0===C?void 0:C.description)||""),W([F]||0)}),[C,I]);var K=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"done"===n.file.status?(W([{id:(0,Z.Z)(),url:n.file.url,name:n.file.name,alt:n.file.name.substr(0,n.file.name.lastIndexOf("."))}]),X("url",[{id:(0,Z.Z)(),url:n.file.url,name:n.file.name,alt:n.file.name.substr(0,n.file.name.lastIndexOf("."))}]),s.ZP.success("".concat(n.file.name," file uploaded successfully"))):"error"===n.file.status&&s.ZP.error("".concat(n.file.name," file upload failed."));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),A=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(n){var t,r,l,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.file,r=n.onSuccess,l=n.onError;try{(a=new FileReader).readAsDataURL(t),a.onload=function(e){var n=new Image;n.src=e.target.result,n.onload=function(){var e,i,l=n.width/n.height;n.width>800||n.height>800?l>1?(e=800,i=800/l):(e=800*l,i=800):(e=n.width,i=n.height);var a=document.createElement("canvas"),o=a.getContext("2d");a.width=e,a.height=i,o.drawImage(n,0,0,e,i),a.toBlob((function(e){var n=new File([e],t.name,{type:t.type}),i=(0,p.iH)(j.t,"/manager-page/".concat(n.name)),l=(0,p.B0)(i,n);l.on("state_changed",(function(e){Math.round(e.bytesTransferred/e.totalBytes*100)}),(function(e){return console.log(e)}),(function(){(0,p.Jt)(l.snapshot.ref).then((function(e){r(),K({file:{status:"done",name:n.name,url:e}})}))}))}),t.type)}}}catch(i){console.error("Error uploading file:",i),l()}case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),G={name:"file",multiple:!1,listType:"picture",customRequest:A,onChange:function(e){var n=e.fileList;if(n.length>0){var t=null===O||void 0===O?void 0:O.reduce((function(e,t){return n.some((function(e){var n;return null===t||void 0===t||null===(n=t.id)||void 0===n?void 0:n.includes(null===e||void 0===e?void 0:e.id)}))&&e.push(t),e}),[]);W(t),X("serviceUrl",t)}},fileList:O,onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)}};return(0,w.jsxs)(w.Fragment,{children:[R,(0,w.jsxs)(d.Z,{form:I,name:"control-edit-create-wedding-ref",ref:N,layout:"vertical",initialValues:H,onFinish:z(function(){var e=(0,l.Z)((0,i.Z)().mark((function e(r){var l,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=(0,m.map)(n,(function(e){var n,i,l,a;return e.id===t.id?(0,m.assign)({},e,{name:(null===O||void 0===O||null===(n=O[0])||void 0===n?void 0:n.name)||(null===O||void 0===O||null===(i=O[0])||void 0===i?void 0:i.url),alt:(null===O||void 0===O||null===(l=O[0])||void 0===l?void 0:l.alt)||"",url:(null===O||void 0===O||null===(a=O[0])||void 0===a?void 0:a.url)||"",title:r.title,description:r.description}):e})),null===k||void 0===k||k(a),D(!0),E.open({type:"success",content:"C\u1eadp nh\u1eadp th\xe0nh c\xf4ng!",duration:5}),D(!1),I.resetFields(),null===(l=N.current)||void 0===l||l.resetFields(),M(),null===x||void 0===x||x();case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),children:[(0,w.jsx)(y.x,{control:_,name:"url",label:"Upload h\xecnh \u1ea3nh d\u1ecbch v\u1ee5",children:(0,w.jsx)(h.Z,(0,r.Z)((0,r.Z)({},G),{},{children:(0,w.jsx)(f.ZP,{icon:(0,w.jsx)(u.Z,{}),children:"Upload"})}))}),(0,w.jsx)(y.x,{control:_,name:"title",label:"T\xean d\u1ecbch v\u1ee5",children:(0,w.jsx)(v.Z,{allowClear:!0,placeholder:"Nh\u1eadp ti\xeau \u0111\u1ec1 d\u1ecbch v\u1ee5"})}),(0,w.jsx)(y.x,{control:_,name:"description",label:"N\u1ed9i dung d\u1ecbch v\u1ee5",children:(0,w.jsx)(v.Z,{allowClear:!0,placeholder:"Nh\u1eadp n\u1ed9i dung d\u1ecbch v\u1ee5"})}),(0,w.jsx)(f.ZP,{loading:q,disabled:!(0,m.isEmpty)(Q),type:"primary",htmlType:"submit",block:!0,size:"large",children:"C\u1eadp nh\u1eadt"})]})]})}},84207:function(e,n,t){t.r(n),t.d(n,{default:function(){return J}});var r=t(74165),i=t(15861),l=t(1413),a=t(29439),o=t(72791),u=t(86005),c=t(60573),d=t(61431),s=t(91082),h=t(9773),f=(t(31773),t(2641)),v=t(1630),p=t(56207),m=(t(96263),t(11730),t(28624)),g=t(56355),Z=t(78820),x=t(16856),y=t(10049),j=t(61758),w=t(91933),b=t(12481),k=t(54174),C=t(763),F=t(18106),N=t(99896),S=t(93433),I=t(66776),P=t(44695),V=t(93070),E=t(4206),R=t(54941),T=t(30276),U=t(61134),q=t(54261),D=t(8007),L=t(47701),B=t(12535),O=t(80184),W=D.Ry({title:D.Z_().required("Vui l\xf2ng nh\u1eadp ti\xeau \u0111\u1ec1 d\u1ecbch v\u1ee5!"),gallery:D.nK().required("Vui l\xf2ng upload file h\xecnh \u1ea3nh").test("fileEmpty","Vui l\xf2ng upload file h\xecnh \u1ea3nh",(function(e){return 0!==(null===e||void 0===e?void 0:e.length)}))}).required();function H(e){var n=e.defaultValues,t=e.handleCancel,c=e.refetch,d=(0,o.useRef)(null),s=V.Z.useForm(),v=(0,a.Z)(s,1)[0],p=E.ZP.useMessage(),m=(0,a.Z)(p,2),g=m[0],Z=m[1],x=(0,o.useState)(!1),y=(0,a.Z)(x,2),j=y[0],F=y[1],N=(0,o.useState)([]),D=(0,a.Z)(N,2),H=D[0],J=D[1],_=(0,o.useState)({}),z=(0,a.Z)(_,2),Q=z[0],M=z[1],X=(0,o.useState)(!1),K=(0,a.Z)(X,2),A=K[0],G=K[1],Y=(0,b.hJ)(k.R,"priceWedding"),$=(0,w.useQueryClient)(),ee=(0,U.cI)({defaultValues:n,resolver:(0,P.X)(W)}),ne=ee.control,te=ee.handleSubmit,re=ee.formState.errors,ie=ee.reset,le=ee.setValue;(0,o.useEffect)((function(){v.setFieldsValue({title:(null===n||void 0===n?void 0:n.title)||"",gallery:n.gallery}),le("title",null===n||void 0===n?void 0:n.title),le("gallery",(null===n||void 0===n?void 0:n.gallery)||[]),J((null===n||void 0===n?void 0:n.gallery)||[])}),[n,v]);var ae=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"done"===n.file.status?(J((function(e){return[].concat((0,S.Z)(e),[{id:(0,q.Z)(),url:n.file.url,name:n.file.name,alt:n.file.name.substr(0,n.file.name.lastIndexOf("."))}])})),le("gallery",[].concat((0,S.Z)(H),[{id:(0,q.Z)(),url:n.file.url,name:n.file.name,alt:n.file.name.substr(0,n.file.name.lastIndexOf("."))}])),E.ZP.success("".concat(n.file.name," file uploaded successfully"))):"error"===n.file.status&&E.ZP.error("".concat(n.file.name," file upload failed."));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),oe=function(){G(!1)},ue=function(e){var n,t=e.originNode,r=e.file;return(0,O.jsxs)("div",{className:"mt-2",children:[t,(0,O.jsx)(f.ZP,{onClick:(n=r,function(){G(!0),M(n)}),children:"Ch\u1ec9nh s\u1eeda"})]})},ce=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){var t,i,l,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.file,i=n.onSuccess,l=n.onError;try{(a=new FileReader).readAsDataURL(t),a.onload=function(e){var n=new Image;n.src=e.target.result,n.onload=function(){var e,r,l=n.width/n.height;n.width>800||n.height>800?l>1?(e=800,r=800/l):(e=800*l,r=800):(e=n.width,r=n.height);var a=document.createElement("canvas"),o=a.getContext("2d");a.width=e,a.height=r,o.drawImage(n,0,0,e,r),a.toBlob((function(e){var n=new File([e],t.name,{type:t.type}),r=(0,T.iH)(k.t,"/manager-page/".concat(n.name)),l=(0,T.B0)(r,n);l.on("state_changed",(function(e){Math.round(e.bytesTransferred/e.totalBytes*100)}),(function(e){return console.log(e)}),(function(){(0,T.Jt)(l.snapshot.ref).then((function(e){i(),ae({file:{status:"done",name:n.name,url:e}})}))}))}),t.type)}}}catch(r){console.error("Error uploading file:",r),l()}case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),de={name:"file",multiple:!0,listType:"picture-card",customRequest:ce,onChange:function(e){var n=e.fileList;if(H.length>0){var t=null===H||void 0===H?void 0:H.reduce((function(e,t){return n.some((function(e){var n;return null===t||void 0===t||null===(n=t.id)||void 0===n?void 0:n.includes(null===e||void 0===e?void 0:e.id)}))&&e.push(t),e}),[]);J(t),le("gallery",t)}},fileList:H,onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)}};return(0,O.jsxs)(O.Fragment,{children:[Z,(0,O.jsxs)(V.Z,{form:v,name:"control-edit-wedding-ref",ref:d,layout:"vertical",initialValues:n,onFinish:te(function(){var e=(0,i.Z)((0,r.Z)().mark((function e(l){var a,o,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={title:(null===l||void 0===l?void 0:l.title)||"",gallery:H},console.log("payload",o),u=(0,b.JU)(Y,null===n||void 0===n?void 0:n.id),e.next=5,(0,b.r7)(u,o);case 5:$.invalidateQueries("priceWedding"),setTimeout((0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),300),F(!0),g.open({type:"success",content:"C\u1eadp nh\u1eadp th\xe0nh c\xf4ng!",duration:5}),F(!1),v.resetFields(),null===(a=d.current)||void 0===a||a.resetFields(),ie(),null===t||void 0===t||t();case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),children:[(0,O.jsx)(L.x,{control:ne,name:"title",label:"T\xean d\u1ecbch v\u1ee5",children:(0,O.jsx)(u.Z,{allowClear:!0,placeholder:"Nh\u1eadp ti\xeau \u0111\u1ec1 d\u1ecbch v\u1ee5"})}),(0,O.jsx)(L.x,{control:ne,name:"gallery",label:"Upload danh s\xe1ch h\xecnh detail v\u1ec1 b\u1ea3ng gi\xe1",children:(0,O.jsxs)(R.Z,(0,l.Z)((0,l.Z)({},de),{},{itemRender:function(e,n){return(0,O.jsx)(ue,{originNode:e,file:n})},children:[(0,O.jsx)("p",{className:"ant-upload-drag-icon",children:(0,O.jsx)(I.Z,{})}),(0,O.jsx)("p",{className:"ant-upload-text",children:"Nh\u1ea5p ho\u1eb7c k\xe9o t\u1ec7p v\xe0o khu v\u1ef1c n\xe0y \u0111\u1ec3 t\u1ea3i l\xean"}),(0,O.jsx)("p",{className:"ant-upload-hint",children:"H\u1ed7 tr\u1ee3 t\u1ea3i l\xean m\u1ed9t l\u1ea7n ho\u1eb7c h\xe0ng lo\u1ea1t. Nghi\xeam c\u1ea5m t\u1ea3i l\xean d\u1eef li\u1ec7u c\xf4ng ty ho\u1eb7c c\xe1c th\xf4ng tin kh\xe1c"})]}))}),(0,O.jsx)(f.ZP,{loading:j,disabled:!(0,C.isEmpty)(re),type:"primary",htmlType:"submit",block:!0,size:"large",children:"C\u1eadp nh\u1eadt"})]}),(0,O.jsx)(h.Z,{centered:!0,footer:null,open:A,onCancel:oe,title:"Ch\u1ec9nh s\u1eeda th\xf4ng tin detail b\u1ea3ng gi\xe1",children:(0,O.jsx)(B.Z,{data:H,file:Q,handleCancel:oe,handleUpdateItem:function(e){J(e)}})})]})}var J=function(){var e=(0,o.useState)(""),n=(0,a.Z)(e,2),t=(n[0],n[1],(0,o.useState)("")),u=(0,a.Z)(t,2),f=(u[0],u[1],(0,o.useRef)(null),(0,w.useQueryClient)()),S=(0,N.W)(),I=S.data,P=(S.isLoading,S.refetch),V=(0,b.hJ)(k.R,"priceWedding"),E=(0,o.useState)(!1),R=(0,a.Z)(E,2),T=R[0],U=R[1],q=(0,F.a)().user,D=(0,o.useState)({title:"",gallery:[],id:""}),L=(0,a.Z)(D,2),B=L[0],W=L[1],J=function(e){return function(){W((0,l.Z)({},e)),U(!0)}},_=function(){U(!1)},z=function(e){return(0,i.Z)((0,r.Z)().mark((function n(){var t;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=(0,b.JU)(V,null===e||void 0===e?void 0:e.id),n.next=3,(0,b.oe)(t);case 3:f.invalidateQueries("priceWedding"),setTimeout((0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),300);case 5:case"end":return n.stop()}}),n)})))},Q=[{title:"T\xean ti\xeau \u0111\u1ec1 b\u1ea3ng gi\xe1 c\u01b0\u1edbi",dataIndex:"title",key:"title",sorter:function(e,n){return e.title.localeCompare(n.title)},sortDirections:["descend","ascend"]},{title:"Danh s\xe1ch h\xecnh \u1ea3nh b\u1ea3ng gi\xe1",dataIndex:"gallery",key:"gallery",render:function(e,n){var t;return(0,O.jsx)(c.Z.PreviewGroup,{items:(0,C.map)(e,"url"),preview:{imageRender:function(n,t){var r,i;return(0,O.jsx)("div",{className:"ml-2 overflow-hidden bg-cover rounded-lg cursor-pointer w-6/12 h-[400px] group",style:{backgroundImage:"url(".concat(n.props.src,")")},children:(0,O.jsx)("div",{className:"overlay",children:(0,O.jsxs)("div",{className:"border-animate",children:[(0,O.jsx)("h2",{className:"mt-4 text-xl md:text-2xl font-semibold text-white capitalize",children:null===e||void 0===e||null===(r=e[t.current])||void 0===r?void 0:r.title}),(0,O.jsx)("p",{className:"mt-2 opacity-0 transition-opacity duration-300 group-hover:opacity-100 text-base tracking-wider text-white uppercase",children:null===e||void 0===e||null===(i=e[t.current])||void 0===i?void 0:i.description})]})})})}},children:(0,O.jsx)(c.Z,{src:null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.url,width:40,height:40,preview:{mask:(0,O.jsx)(Z.Zju,{})}})})}}];return"admin"===(null===q||void 0===q?void 0:q.permission)&&Q.push({title:"Ch\u1ec9nh s\u1eeda",dataIndex:"",key:"x",render:function(e,n){return(0,O.jsxs)("div",{className:"flex items-center gap-2",children:[(0,O.jsx)(d.Z,{title:"Ch\u1ec9nh s\u1eeda",children:(0,O.jsx)(y.Z,{override:j.O.primary,type:"primary",size:"small",icon:(0,O.jsx)(g.fmQ,{}),onClick:J(n)})}),(0,O.jsx)(d.Z,{title:"Xo\xe1",children:(0,O.jsx)(s.Z,{title:"X\xf3a b\u1ea3ng gi\xe1 d\u1ecbch v\u1ee5 c\u01b0\u1edbi",description:"B\u1ea1n c\xf3 ch\u1eafc l\xe0 mu\u1ed1n x\xf3a b\u1ea3ng gi\xe1 d\u1ecbch v\u1ee5 c\u01b0\u1edbi?",icon:(0,O.jsx)(m.Z,{style:{color:j.O.red2}}),onConfirm:z(n),children:(0,O.jsx)(y.Z,{override:j.O.red2,type:"primary",size:"small",icon:(0,O.jsx)(x.FH3,{})})})})]})}}),(0,O.jsxs)("div",{className:"m-6 p-2 md:p-10 bg-white rounded-3xl",children:[(0,O.jsx)("div",{className:"mb-4",children:(0,O.jsx)(v.Z,{items:[{href:"/",title:"Trang ch\u1ee7"},{title:"Danh s\xe1ch b\u1ea3ng gi\xe1"}]})}),(0,O.jsx)(p.Z,{rowKey:function(e){return e.id},columns:Q,dataSource:I,bordered:!0,scroll:{x:800}}),(0,O.jsx)(h.Z,{title:"C\u1eadp nh\u1eadt b\u1ea3ng gi\xe1",open:T,footer:null,centered:!0,onCancel:_,children:(0,O.jsx)(H,{defaultValues:B,handleCancel:_,refetch:P})})]})}},99896:function(e,n,t){t.d(n,{W:function(){return c}});var r=t(74165),i=t(15861),l=t(1413),a=t(20028),o=t(12481),u=t(54174);function c(){var e=(0,o.IO)((0,o.hJ)(u.R,"priceWedding")),n=(0,a.sQ)(["priceWedding"],e),t=n.data,c=[];null===t||void 0===t||t.forEach((function(e){c.push((0,l.Z)({id:e.id},e.data()))}));var d=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.refetch();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Error refetching tea, data:",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return{isError:n.isError,isLoading:n.isLoading,data:c,refetch:d}}}}]);
//# sourceMappingURL=4207.8b126967.chunk.js.map