"use strict";(self.webpackChunkmardoll_admin=self.webpackChunkmardoll_admin||[]).push([[1145],{47701:function(e,n,t){t.d(n,{x:function(){return s}});var i=t(1413),r=t(44925),a=(t(72791),t(93070)),o=t(61134),l=t(80184),c=["children","control","name","help","hasFeedback"],s=function(e){var n,t,s=e.children,d=e.control,u=e.name,h=e.help,m=e.hasFeedback,p=void 0!==m&&m,v=(0,r.Z)(e,c),f=(0,o.bc)({name:u,control:d}),g=f.field,w=f.fieldState,x=f.formState.errors;return(0,l.jsx)(a.Z.Item,(0,i.Z)((0,i.Z)({hasFeedback:p,name:u,normalize:function(e){return g.onChange(e),e},validateStatus:w.invalid?"error":void 0,help:null!==(n=null===(t=x[u])||void 0===t?void 0:t.message)&&void 0!==n?n:h},v),{},{children:s}))}},31145:function(e,n,t){t.r(n),t.d(n,{default:function(){return _}});var i=t(72791),r=t(1630),a=t(1413),o=t(74165),l=t(15861),c=t(29439),s=t(71439),d=t(93070),u=t(4206),h=t(86005),m=t(5535),p=t(2641),v=t(61134),f=t(44695),g=t(8007),w=t(77154),x=t(98272),Z=t(66776),y=t(763),b=t(47701),j=t(54174),k=t(30276),N=t(12481),S=t(20028),C=t(71781),F=t(25850),V=t(67441),E=t(91933),T=t(18106),q=t(80184),O=s.Z.Dragger,I={name:"",phone:"",email:"",password:"",address:"",permission:"",avatar:"https://firebasestorage.googleapis.com/v0/b/mardoll-studio.appspot.com/o/profile.png?alt=media&token=317fa84c-f068-47d4-aa48-4943fad74b2b"},Q=g.Ry({name:g.Z_().required("Vui l\xf2ng nh\u1eadp t\xean"),permission:g.Z_().required("Vui ch\u1ecdn quy\u1ec1n"),phone:g.Z_().required("Vui l\xf2ng nh\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i c\u1ee7a b\u1ea1n!").test("phone","S\u1ed1 \u0111i\xean tho\u1ea1i sai \u0111\u1ecbnh d\u1ea1ng",(function(e,n){return(0,F.Hl)(e)})),email:g.Z_().email("Sai \u0111\u1ecbnh dang email. V\xed d\u1ee5 abc@gmail.com").required("Vui l\xf2ng nh\u1eadp email c\u1ee7a b\u1ea1n"),password:g.Z_().min(8,"\u0110\u1ed9 d\xe0i t\u1eeb 8-50 k\xed t\u1ef1").max(50,"\u0110\u1ed9 d\xe0i t\u1eeb 8-50 k\xed t\u1ef1").matches(F.Gw,"Ch\u1ee9a \xedt nh\u1ea5t m\u1ed9t k\xed t\u1ef1 th\u01b0\u1eddng, m\u1ed9t k\xed t\u1ef1 hoa, m\u1ed9t k\xed t\u1ef1 \u0111\u1eb7c bi\u1ec7t v\xe0 m\u1ed9t s\u1ed1").required("Vui l\xf2ng nh\u1eadp m\u1eadt kh\u1ea9u"),address:g.Z_().required("Vui l\xf2ng \u0111\u1ecba ch\u1ec9"),avatar:g.nK().required("Vui l\xf2ng upload file h\xecnh \u1ea3nh").test("fileEmpty","Vui l\xf2ng upload file h\xecnh \u1ea3nh",(function(e){return 0!==(null===e||void 0===e?void 0:e.length)}))}).required();function R(){var e=(0,i.useRef)(null),n=d.Z.useForm(),t=(0,c.Z)(n,1)[0],r=u.ZP.useMessage(),s=(0,c.Z)(r,2),g=s[0],F=s[1],R=(0,i.useState)(!1),_=(0,c.Z)(R,2),D=_[0],L=_[1],P=(0,N.hJ)(j.R,"employee"),A=(0,S.b)(P),z=(0,V.E)().refetchTeam,J=(0,E.useQueryClient)(),M=(0,T.a)().user,G=(null===M||void 0===M?void 0:M.permission)||"",H=(0,v.cI)({defaultValues:I,resolver:(0,f.X)(Q)}),$=H.control,B=H.handleSubmit,U=H.formState.errors,X=H.reset,K=H.setValue,W=(H.getValues,function(){var e=(0,l.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"done"===n.file.status?(K("avatar",n.file.url),u.ZP.success("".concat(n.file.name," file uploaded successfully"))):"error"===n.file.status&&u.ZP.error("".concat(n.file.name," file upload failed."));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),Y=function(){var e=(0,l.Z)((0,o.Z)().mark((function e(n){var t,i,r,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.file,i=n.onSuccess,r=n.onError;try{(a=new FileReader).readAsDataURL(t),a.onload=function(e){var n=new Image;n.src=e.target.result,n.onload=function(){var e,r,a=n.width/n.height;n.width>800||n.height>800?a>1?(e=800,r=800/a):(e=800*a,r=800):(e=n.width,r=n.height);var o=document.createElement("canvas"),l=o.getContext("2d");o.width=e,o.height=r,l.drawImage(n,0,0,e,r),o.toBlob((function(e){var n=new File([e],t.name,{type:t.type}),r=(0,k.iH)(j.t,"/files/".concat(n.name)),a=(0,k.B0)(r,n);a.on("state_changed",(function(e){Math.round(e.bytesTransferred/e.totalBytes*100)}),(function(e){return console.log(e)}),(function(){(0,k.Jt)(a.snapshot.ref).then((function(e){i(),W({file:{status:"done",name:n.name,url:e}})}))}))}),t.type)}}}catch(o){console.error("Error uploading file:",o),r()}case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ee={name:"file",multiple:!1,customRequest:Y,onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)}};return(0,q.jsxs)(q.Fragment,{children:[F,(0,q.jsxs)(d.Z,{form:t,name:"control-form-create-employee-ref",ref:e,layout:"vertical",initialValues:I,onFinish:B(function(){var n=(0,l.Z)((0,o.Z)().mark((function n(i){var r,c,s,d;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return L(!0),c=(0,N.IO)(P,(0,N.ar)("email","==",i.email),(0,N.b9)(1)),n.next=4,(0,N.PL)(c);case 4:if(n.sent.empty){n.next=9;break}return g.open({type:"error",content:"Email ".concat(null===i||void 0===i?void 0:i.email," n\xe0y \u0111\xe3 t\u1ed3n t\u1ea1i trong h\u1ec7 th\u1ed1ng vui l\xf2ng nh\u1eadp email kh\xe1c!"),duration:5}),L(!1),n.abrupt("return");case 9:s=C.I.find((function(e){var n,t;return e.id===(null===i||void 0===i||null===(n=i.permission)||void 0===n||null===(t=n.toLowerCase)||void 0===t?void 0:t.call(n))})),d=(0,a.Z)((0,a.Z)({},i),{},{createAt:(new Date).toISOString(),permissions:null===s||void 0===s?void 0:s.permissions}),A.mutate(d),J.invalidateQueries("employee"),setTimeout((0,l.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),300),g.open({type:"success",content:"T\u1ea1o th\xe0nh vi\xean th\xe0nh c\xf4ng!",duration:5}),L(!1),t.resetFields(),null===(r=e.current)||void 0===r||r.resetFields(),X();case 19:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),children:[(0,q.jsx)(b.x,{control:$,name:"email",label:"Email",children:(0,q.jsx)(h.Z,{allowClear:!0,placeholder:"Nh\u1eadp email"})}),(0,q.jsx)(b.x,{control:$,name:"password",label:"Password",children:(0,q.jsx)(h.Z.Password,{allowClear:!0,iconRender:function(e){return e?(0,q.jsx)(w.Z,{}):(0,q.jsx)(x.Z,{})},placeholder:"Nh\u1eadp email"})}),(0,q.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 xl:gap-6",children:[(0,q.jsx)(b.x,{control:$,name:"name",label:"T\xean nh\xe2n vi\xean",children:(0,q.jsx)(h.Z,{allowClear:!0,placeholder:"Nh\u1eadp t\xean nh\xe2n vi\xean"})}),(0,q.jsx)(b.x,{control:$,name:"phone",label:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i",children:(0,q.jsx)(h.Z,{allowClear:!0,placeholder:"Nh\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i"})}),(0,q.jsx)(b.x,{control:$,name:"permission",label:"Quy\u1ec1n",children:(0,q.jsx)(m.Z,{children:"admin"===G?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(m.Z.Option,{value:"admin",children:"Qu\u1ea3n tr\u1ecb vi\xean"}),(0,q.jsx)(m.Z.Option,{value:"manager",children:"Qu\u1ea3n l\xfd"}),(0,q.jsx)(m.Z.Option,{value:"employee",children:"Th\u1ee3 ch\u1ee5p \u1ea3nh"}),(0,q.jsx)(m.Z.Option,{value:"sale",children:"Sale"}),(0,q.jsx)(m.Z.Option,{value:"marketing",children:"Marketing"})]}):(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(m.Z.Option,{value:"employee",children:"Th\u1ee3 ch\u1ee5p \u1ea3nh"}),(0,q.jsx)(m.Z.Option,{value:"sale",children:"Sale"}),(0,q.jsx)(m.Z.Option,{value:"marketing",children:"Marketing"})]})})})]}),(0,q.jsx)(b.x,{control:$,name:"address",label:"\u0110\u1ecba ch\u1ec9",children:(0,q.jsx)(h.Z,{allowClear:!0,placeholder:"Nh\u1eadp \u0111\u1ecba ch\u1ec9"})}),(0,q.jsx)("div",{className:"py-6",children:(0,q.jsx)(b.x,{control:$,name:"avatar",label:"Upload h\xecnh \u1ea3nh",children:(0,q.jsxs)(O,(0,a.Z)((0,a.Z)({},ee),{},{children:[(0,q.jsx)("p",{className:"ant-upload-drag-icon",children:(0,q.jsx)(Z.Z,{})}),(0,q.jsx)("p",{className:"ant-upload-text",children:"Nh\u1ea5p ho\u1eb7c k\xe9o t\u1ec7p v\xe0o khu v\u1ef1c n\xe0y \u0111\u1ec3 t\u1ea3i l\xean"}),(0,q.jsx)("p",{className:"ant-upload-hint",children:"H\u1ed7 tr\u1ee3 t\u1ea3i l\xean m\u1ed9t l\u1ea7n ho\u1eb7c h\xe0ng lo\u1ea1t. Nghi\xeam c\u1ea5m t\u1ea3i l\xean d\u1eef li\u1ec7u c\xf4ng ty ho\u1eb7c c\xe1c th\xf4ng tin kh\xe1c"})]}))})}),(0,q.jsx)(p.ZP,{loading:D,disabled:!(0,y.isEmpty)(U),type:"primary",htmlType:"submit",block:!0,size:"large",children:"G\u1eedi"})]})]})}var _=function(){var e=(0,T.a)().user,n=(null===e||void 0===e?void 0:e.permissions)||{};return(0,q.jsx)("div",{className:"m-2 p-2 md:p-10 bg-white rounded-3xl",children:(0,F.yA)(n,"employees")&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("div",{className:"mb-4",children:(0,q.jsx)(r.Z,{items:[{href:"/",title:"Trang ch\u1ee7"},{title:"T\u1ea1o nh\xe2n vi\xean"}]})}),(0,q.jsx)(R,{})]})})}},67441:function(e,n,t){t.d(n,{E:function(){return d}});var i=t(74165),r=t(15861),a=t(1413),o=t(54174),l=t(20028),c=t(12481),s=t(18106);function d(){var e=(0,s.a)().user,n=(null===e||void 0===e?void 0:e.permission)||null,t=(0,c.IO)((0,c.hJ)(o.R,"employee")),d=(0,l.sQ)(["employee"],t),u=d.data,h=[];null===u||void 0===u||u.forEach((function(e){h.push((0,a.Z)({id:e.id},e.data()))})),"admin"!==n&&(h=h.filter((function(e){return"admin"!==e.permission})));var m=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.refetch();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Error refetching team data:",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return{isError:d.isError,isLoading:d.isLoading,data:h,refetchTeam:m}}},25850:function(e,n,t){t.d(n,{$5:function(){return o},Dw:function(){return a},Gw:function(){return l},Hl:function(){return c},J5:function(){return h},Q_:function(){return f},Rf:function(){return v},cX:function(){return p},k7:function(){return m},uf:function(){return d},xG:function(){return s},yA:function(){return u},z2:function(){return r}});var i=t(763),r=function(){return{pending:"orange",active:"cyan",complete:"green",rejected:"red",canceled:"red"}[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"pending"]},a=function(){return{offline:"gray",online:"green"}[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"offline"]};function o(e){var n,t,i;return e=null===(i=e=null===(n=e)||void 0===n||null===(t=n.normalize("NFD").replace(/[\u0300-\u036f]/g,""))||void 0===t?void 0:t.replace("\u0111","d"))||void 0===i?void 0:i.replace(/\s+/g,"-").toLowerCase()}var l=/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/,c=function(e){return/((^(\+84|84|0|0084){1})(3|5|7|8|9))+([0-9]{8})$/.test(e)},s=function(e){return(0,i.isNil)(e)||(0,i.isEmpty)(e)?"--":parseInt(e).toLocaleString("vi-VN",{style:"currency",currency:"VND"})},d=function(e){return 0===e?"".concat(e.toString()):e>=1e9?"".concat((e/1e9).toFixed(0)," t\u1ef7"):e>=1e6?"".concat((e/1e6).toFixed(0)," tr"):"".concat((e/1e3).toFixed(0)," k")},u=function(e,n){var t;return null===e||void 0===e||null===(t=e[n])||void 0===t?void 0:t.includes("create")},h=function(e,n){var t;return null===e||void 0===e||null===(t=e[n])||void 0===t?void 0:t.includes("edit")},m=function(e,n){var t;return null===e||void 0===e||null===(t=e[n])||void 0===t?void 0:t.includes("delete")},p=function(e,n,t){return function(e,n){var t;return null===e||void 0===e||null===(t=e[n])||void 0===t?void 0:t.includes("view")}(t,e)?n:null},v=function(e){return(0,i.chain)(e).replace(/\D/g,"").toArray().takeRight(3).join("").value()},f=function(e){return(0,i.chain)(e).trim().split(/\s+/).last().defaultTo("").value()}},71781:function(e){e.exports=JSON.parse('{"I":[{"id":"admin","name":"Qu\u1ea3n tr\u1ecb vi\xean","description":"C\xf3 to\xe0n quy\u1ec1n truy c\u1eadp h\u1ec7 th\u1ed1ng","permissions":{"ecommerce":["view","create","edit","delete"],"employees":["view","create","edit","delete"],"contracts":["view","create","edit","delete"],"wedding-dresses":["view","create","edit","delete"],"member-management":["view","create","edit","delete"],"pricing":["view","create","edit","delete"],"page-management":["view","create","edit","delete"],"customer-contact":["view","create","edit","delete"],"booking-schedule":["view","create","edit","delete"],"machine-schedule":["view","create","edit","delete"]}},{"id":"manager","name":"Qu\u1ea3n l\xfd","description":"Qu\u1ea3n l\xfd c\xe1c ho\u1ea1t \u0111\u1ed9ng kinh doanh ch\xednh","permissions":{"ecommerce":["view","create","edit"],"employees":["view","create","edit"],"contracts":["view","create","edit"],"wedding-dresses":["view","create","edit","delete"],"member-management":["view","create","edit"],"pricing":["view","edit"],"page-management":["view","edit"],"customer-contact":["view","create","edit"],"booking-schedule":["view","create","edit","delete"],"machine-schedule":["view","create","edit","delete"]}},{"id":"employee","name":"Th\u1ee3 ch\u1ee5p \u1ea3nh","description":"Chuy\xean vi\xean ch\u1ee5p \u1ea3nh v\xe0 x\u1eed l\xfd h\xecnh \u1ea3nh","permissions":{"machine-schedule":["view"]}},{"id":"sale","name":"Sale","description":"Chuy\xean vi\xean t\u01b0 v\u1ea5n v\xe0 b\xe1n h\xe0ng","permissions":{"contracts":["view","create","edit"],"wedding-dresses":["view","create","edit"],"member-management":["view","create","edit"],"pricing":["view","create","edit","delete"],"page-management":["view","create","edit","delete"],"customer-contact":["view","create","edit","delete"],"booking-schedule":["view","create","edit","delete"],"machine-schedule":["view","create","edit"]}},{"id":"marketing","name":"Marketing","description":"Chuy\xean vi\xean marketing v\xe0 qu\u1ea3ng c\xe1o","permissions":{"contracts":["view","create","edit"],"wedding-dresses":["view","create","edit"],"member-management":["view","create","edit"],"pricing":["view","create","edit","delete"],"page-management":["view","create","edit","delete"],"customer-contact":["view","create","edit","delete"],"booking-schedule":["view","create","edit","delete"],"machine-schedule":["view","create","edit"]}}]}')}}]);
//# sourceMappingURL=1145.e58c5264.chunk.js.map