"use strict";(self.webpackChunkmardoll_admin=self.webpackChunkmardoll_admin||[]).push([[9910],{84733:function(e,t,n){n.d(t,{Z:function(){return f}});var i=n(29439),o=n(72791),r=n(66770),c=n.n(r),l=n(11152),a=n(53115),s=n(35722),d=n(40738),u=n(72221);function h(e){var t=(0,a.j)().use(s.Z,{emitParseErrors:!0,duplicateAttribute:!1}).use(d.Z).use(u.Z).processSync(e);return String(t)}n(86009),n(9826);var v=n(80184);r.Quill.register("modules/emoji",l);var p=[[{header:[1,2,3,!1]}],["bold","italic","underline","strike","blockquote","link"],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],["emoji"],["clean"]];function f(e){var t,n,r,l=(0,o.useState)((null===e||void 0===e||null===(t=e.value)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.html)||(null===e||void 0===e||null===(r=e.value)||void 0===r?void 0:r.html)),a=(0,i.Z)(l,2),s=a[0],d=a[1],u=(0,o.useRef)(null);return(0,o.useEffect)((function(){var t,n,i;return d((null===e||void 0===e||null===(t=e.value)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.html)||(null===e||void 0===e||null===(i=e.value)||void 0===i?void 0:i.html))}),[null===e||void 0===e?void 0:e.value]),(0,v.jsx)(c(),{ref:u,theme:"snow",placeholder:"Nh\u1eadp ch\xfa th\xedch c\u1ee7a h\u1ee3p \u0111\u1ed3ng",modules:{toolbar:{container:p},"emoji-toolbar":!0,"emoji-textarea":!1,"emoji-shortname":!0},className:"h-[360px]",value:s,onChange:function(t){d(t),e.onChange&&e.onChange({html:t,markdown:h(t)})}})}},28248:function(e,t,n){n.d(t,{L:function(){return s}});var i=n(74165),o=n(15861),r=n(1413),c=n(20028),l=n(12481),a=n(54174);function s(){var e=(0,l.IO)((0,l.hJ)(a.R,"contractType")),t=(0,c.sQ)(["contractType"],e),n=t.data,s=[];null===n||void 0===n||n.forEach((function(e){s.push((0,r.Z)({id:e.id},e.data()))}));var d=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.refetch();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Error refetching wedding dress data:",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return{isError:t.isError,isLoading:t.isLoading,data:s,refetch:d}}},64474:function(e,t,n){n.d(t,{y:function(){return s}});var i=n(74165),o=n(15861),r=n(1413),c=n(20028),l=n(12481),a=n(54174);function s(){var e=(0,l.IO)((0,l.hJ)(a.R,"servicesArising")),t=(0,c.sQ)(["servicesArising"],e),n=t.data,s=[];null===n||void 0===n||n.forEach((function(e){s.push((0,r.Z)({id:e.id},e.data()))}));var d=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.refetch();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Error refetching wedding dress data:",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return{isError:t.isError,isLoading:t.isLoading,data:s,refetch:d}}},29910:function(e,t,n){n.r(t),n.d(t,{default:function(){return de}});var i=n(74165),o=n(15861),r=n(1413),c=n(29439),l=n(72791),a=n(86005),s=n(60573),d=n(51678),u=n(61431),h=n(91082),v=n(9773),p=n(31773),f=n(2641),m=n(1630),g=n(56207),x=n(96263),y=n.n(x),Z=n(11730),D=n(28624),j=n(56355),P=n(78820),b=n(16856),N=n(25850),k=n(97892),C=n.n(k),w=n(10049),T=n(61758),S=n(91933),I=n(69813),q=n(12481),M=n(54174),V=n(93433),E=n(66776),A=n(44695),Y=n(44960),F=n(36473),L=n(89862),B=n(71439),O=n(93070),G=n(4206),z=n(98597),R=n(5535),W=n(3725),H=n(30276),J=n(763),Q=n(61134),K=n(54261),U=n(8007),$=n(47701),_=n(84733),X=n(64474),ee=n(93899),te=n(18106),ne=n(28248),ie=n(80184),oe=B.Z.Dragger,re=(C()(),"DD-MM-YYYY"),ce=["pending","active","complete","canceled","rejected"],le=U.Ry({status:U.Z_().required("Vui l\xf2ng ch\u1ecdn tr\u1ea1ng th\xe1i h\u1ee3p \u0111\u1ed3ng"),phone:U.Z_().required("Vui l\xf2ng nh\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i c\u1ee7a b\u1ea1n!").test("phone","S\u1ed1 \u0111i\xean tho\u1ea1i sai \u0111\u1ecbnh d\u1ea1ng",(function(e,t){return(0,N.Hl)(e)})),createDate:U.hT().required("Ch\u1ecdn ng\xe0y k\xfd h\u1ee3p \u0111\u1ed3ng"),shootingDate:U.hT().required("Ch\u1ecdn ng\xe0y b\u1ea5m m\xe1y"),dueDate:U.hT().required("Ch\u1ecdn ng\xe0y ho\xe0n th\xe0nh h\u1ee3p \u0111\u1ed3ng"),address:U.Z_().required("Vui l\xf2ng \u0111\u1ecba ch\u1ec9")}).required();function ae(e){var t,n,s,u=e.defaultValues,v=e.handleCancel,m=e.refetch,g=(0,l.useRef)(null),x=O.Z.useForm(),y=(0,c.Z)(x,1)[0],Z=G.ZP.useMessage(),D=(0,c.Z)(Z,2),j=D[0],P=D[1],b=(0,l.useState)(!1),k=(0,c.Z)(b,2),w=k[0],T=k[1],I=(0,l.useState)(null===u||void 0===u?void 0:u.servicesArisingItems),B=(0,c.Z)(I,2),U=B[0],ae=B[1],se=(0,l.useState)((null===u||void 0===u?void 0:u.contractPriceItems)||[]),de=(0,c.Z)(se,2),ue=de[0],he=de[1],ve=(0,l.useState)(null),pe=(0,c.Z)(ve,2),fe=pe[0],me=pe[1],ge=(0,l.useState)(1),xe=(0,c.Z)(ge,2),ye=xe[0],Ze=xe[1],De=(0,l.useState)(0),je=(0,c.Z)(De,2),Pe=je[0],be=je[1],Ne=(0,l.useState)(!1),ke=(0,c.Z)(Ne,2),Ce=ke[0],we=ke[1],Te=(0,l.useState)(null),Se=(0,c.Z)(Te,2),Ie=Se[0],qe=Se[1],Me=(0,l.useState)(1),Ve=(0,c.Z)(Me,2),Ee=Ve[0],Ae=Ve[1],Ye=(0,l.useState)(0),Fe=(0,c.Z)(Ye,2),Le=Fe[0],Be=Fe[1],Oe=(0,l.useState)(!1),Ge=(0,c.Z)(Oe,2),ze=Ge[0],Re=Ge[1],We=(0,q.hJ)(M.R,"contract"),He=(0,S.useQueryClient)(),Je=(0,te.a)().user,Qe="admin"===(null===Je||void 0===Je?void 0:Je.permission),Ke=(0,l.useState)(u.contractImage),Ue=(0,c.Z)(Ke,2),$e=Ue[0],_e=Ue[1],Xe=(0,K.Z)(),et=(0,X.y)().data,tt=(0,ne.L)().data,nt=(0,Q.cI)({mode:"onChange",defaultValues:(0,r.Z)((0,r.Z)({},u),{},{customerType:null!==(t=null===u||void 0===u?void 0:u.customerType)&&void 0!==t?t:"offline",notes:(null===u||void 0===u||null===(n=u.notes)||void 0===n||null===(s=n[0])||void 0===s?void 0:s.html)||"<p></p>"}),resolver:(0,A.X)(le)}),it=nt.control,ot=nt.handleSubmit,rt=nt.formState.errors,ct=nt.reset,lt=nt.setValue;nt.getValues;console.log("defaultValues",u),(0,l.useEffect)((function(){var e,t,n,i,o,r;y.setFieldsValue({id:u.id,contractType:u.contractType,servicesArising:null===u||void 0===u?void 0:u.servicesArising,status:u.status,phone:u.phone,address:u.address,createDate:u.createDate,dueDate:u.dueDate,shootingDate:u.shootingDate,firstDepositPriceDate:u.firstDepositPriceDate,secondDepositPriceDate:u.secondDepositPriceDate,firstDepositPrice:null===u||void 0===u?void 0:u.firstDepositPrice,secondDepositPrice:null===u||void 0===u?void 0:u.secondDepositPrice,contractPrice:u.contractPrice,contractImage:u.contractImage,notes:null===u||void 0===u?void 0:u.notes,firstPaymentMethod:null===u||void 0===u?void 0:u.firstPaymentMethod,secondPaymentMethod:null===u||void 0===u?void 0:u.secondPaymentMethod,userName:null===u||void 0===u?void 0:u.userName,customerType:null!==(e=null===u||void 0===u?void 0:u.customerType)&&void 0!==e?e:"offline",firstCheckDeposit:null!==(t=null===u||void 0===u?void 0:u.firstCheckDeposit)&&void 0!==t&&t,secondCheckDeposit:null!==(n=null===u||void 0===u?void 0:u.secondCheckDeposit)&&void 0!==n&&n}),lt("id",null===u||void 0===u?void 0:u.id),lt("notes",null===u||void 0===u?void 0:u.notes),lt("status",null===u||void 0===u?void 0:u.status),lt("phone",null===u||void 0===u?void 0:u.phone),lt("address",null===u||void 0===u?void 0:u.address),lt("createDate",null===u||void 0===u?void 0:u.createDate),lt("dueDate",null===u||void 0===u?void 0:u.dueDate),lt("shootingDate",null===u||void 0===u?void 0:u.shootingDate),lt("firstDepositPriceDate",null===u||void 0===u?void 0:u.firstDepositPriceDate),lt("secondDepositPriceDate",null===u||void 0===u?void 0:u.secondDepositPriceDate),lt("firstDepositPrice",null===u||void 0===u?void 0:u.firstDepositPrice),lt("secondDepositPrice",null===u||void 0===u?void 0:u.secondDepositPrice),lt("contractPrice",null===u||void 0===u?void 0:u.contractPrice),lt("userName",null===u||void 0===u?void 0:u.userName),lt("contractImage",null===u||void 0===u?void 0:u.contractImage),lt("firstPaymentMethod",null===u||void 0===u?void 0:u.firstPaymentMethod),lt("secondPaymentMethod",null===u||void 0===u?void 0:u.secondPaymentMethod),lt("contractType",u.contractType),lt("customerType",null!==(i=u.customerType)&&void 0!==i?i:"offline"),lt("serviceArising",null===u||void 0===u?void 0:u.servicesArising),_e(u.contractImage),ae((null===u||void 0===u?void 0:u.servicesArisingItems)||[]),he((null===u||void 0===u?void 0:u.contractPriceItems)||[]),lt("firstCheckDeposit",null!==(o=null===u||void 0===u?void 0:u.firstCheckDeposit)&&void 0!==o&&o),lt("secondCheckDeposit",null!==(r=null===u||void 0===u?void 0:u.secondCheckDeposit)&&void 0!==r&&r)}),[u,y,lt]);var at=O.Z.useWatch("contractType",y),st=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"done"===t.file.status?(_e((function(e){return[].concat((0,V.Z)(e),[{id:Xe,url:t.file.url,name:t.file.name}])})),lt("contractImage",[].concat((0,V.Z)($e),[{id:Xe,url:t.file.url,name:t.file.name}])),G.ZP.success("".concat(t.file.name," file uploaded successfully"))):"error"===t.file.status&&G.ZP.error("".concat(t.file.name," file upload failed."));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),dt=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,o,r,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.file,o=t.onSuccess,r=t.onError;try{(c=new FileReader).readAsDataURL(n),c.onload=function(e){var t=new Image;t.src=e.target.result,t.onload=function(){var e,i,r=t.width/t.height;t.width>800||t.height>800?r>1?(e=800,i=800/r):(e=800*r,i=800):(e=t.width,i=t.height);var c=document.createElement("canvas"),l=c.getContext("2d");c.width=e,c.height=i,l.drawImage(t,0,0,e,i),c.toBlob((function(e){var t=new File([e],n.name,{type:n.type}),i=(0,H.iH)(M.t,"/manager-page/".concat(t.name)),r=(0,H.B0)(i,t);r.on("state_changed",(function(e){Math.round(e.bytesTransferred/e.totalBytes*100)}),(function(e){return console.log(e)}),(function(){(0,H.Jt)(r.snapshot.ref).then((function(e){o(),st({file:{status:"done",name:t.name,url:e}})}))}))}),n.type)}}}catch(i){console.error("Error uploading file:",i),r()}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ut={name:"file",multiple:!0,listType:"picture",customRequest:dt,onChange:function(e){var t=e.fileList;if($e.length>0){var n=null===$e||void 0===$e?void 0:$e.reduce((function(e,n){return t.some((function(e){var t;return null===n||void 0===n||null===(t=n.id)||void 0===t?void 0:t.includes(null===e||void 0===e?void 0:e.id)}))&&e.push(n),e}),[]);_e(n),lt("contractImage",n)}},fileList:$e,onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)}},ht=(0,J.map)(et,(function(e){var t=(0,J.find)(U,["value",e.serviceName]);return{value:e.serviceName,label:(0,ie.jsx)("span",{onClick:function(t){var n=(0,J.find)(U,{value:e.serviceName}),i={key:(0,N.$5)("".concat(e.serviceName)),value:e.serviceName,label:e.serviceName,quantity:(null===n||void 0===n?void 0:n.quantity)||ye,discount:(null===n||void 0===n?void 0:n.discount)||Le};if((null===n||void 0===n?void 0:n.quantity)&&Ze(null===n||void 0===n?void 0:n.quantity),(null===n||void 0===n?void 0:n.discount)>=0&&be(null===n||void 0===n?void 0:n.discount),me(e.serviceName),!n){var o=(0,J.find)(et,{serviceName:null===i||void 0===i?void 0:i.value});ae([].concat((0,V.Z)(ue),[(0,r.Z)((0,r.Z)({},i),{},{price:(null===o||void 0===o?void 0:o.servicePrice)||0})]))}we(!0)},children:(0,J.isEmpty)(t)?e.serviceName:"".concat(e.serviceName," - (").concat(null===t||void 0===t?void 0:t.quantity,") ").concat((null===t||void 0===t?void 0:t.discount)>0?"- (discount ".concat((0,N.xG)("".concat(null===t||void 0===t?void 0:t.discount)),")"):"")})}})),vt=(0,J.map)(tt,(function(e){var t=(0,J.find)(ue,["value",e.contractName]);return{value:e.contractName,label:(0,ie.jsx)("span",{onClick:function(t){var n=(0,J.find)(ue,{value:e.contractName}),i={key:(0,N.$5)("".concat(e.contractName)),value:e.contractName,label:e.contractName,quantity:(null===n||void 0===n?void 0:n.quantity)||ye,discount:(null===n||void 0===n?void 0:n.discount)||Le};if((null===n||void 0===n?void 0:n.quantity)&&Ae(null===n||void 0===n?void 0:n.quantity),(null===n||void 0===n?void 0:n.discount)>=0&&Be(null===n||void 0===n?void 0:n.discount),qe(e.contractName),!n){var o=(0,J.find)(tt,{contractName:null===i||void 0===i?void 0:i.value});he([].concat((0,V.Z)(ue),[(0,r.Z)((0,r.Z)({},i),{},{price:(null===o||void 0===o?void 0:o.contractPrice)||0})]))}Re(!0)},children:(0,J.isEmpty)(t)?e.contractName:"".concat(e.contractName," - (").concat(null===t||void 0===t?void 0:t.quantity,") ").concat((null===t||void 0===t?void 0:t.discount)>0?"- (discount ".concat((0,N.xG)("".concat(null===t||void 0===t?void 0:t.discount)),")"):"")})}})),pt=O.Z.useWatch("servicesArising",y),ft=O.Z.useWatch("contractType",y);(0,l.useEffect)((function(){var e=(0,J.reduce)(U,(function(e,t){return e+ +(null===t||void 0===t?void 0:t.discount)||0}),0),t=(0,J.reduce)(ue,(function(e,t){return e+ +(null===t||void 0===t?void 0:t.discount)||0}),0);y.setFieldValue("discount",+t+ +e),lt("discount",+t+ +e)}),[ue,U]),(0,l.useEffect)((function(){if(ft){var e=(0,J.reduce)(ft,(function(e,t){var n=(0,J.find)(ue,{value:t});return n?e+ +(null===n||void 0===n?void 0:n.price)*+(null===n||void 0===n?void 0:n.quantity):e}),0);y.setFieldValue("contractPrice","".concat(+e)),lt("contractPrice","".concat(+e))}})),(0,l.useEffect)((function(){y.setFieldValue("servicesArisingPrice","".concat(+gt)),lt("servicesArisingPrice","".concat(+gt)),lt("servicesArisingItems",U)}));var mt=O.Z.useWatch("contractPrice",y),gt=(0,J.reduce)(U,(function(e,t){return e+ +(null===t||void 0===t?void 0:t.price)*(null===t||void 0===t?void 0:t.quantity)||0}),0),xt=O.Z.useWatch("discount",y),yt=O.Z.useWatch("firstDepositPrice",y),Zt=O.Z.useWatch("secondDepositPrice",y),Dt=O.Z.useWatch("firstCheckDeposit",y),jt=O.Z.useWatch("secondCheckDeposit",y),Pt=(0,J.isUndefined)(xt)?0:+xt,bt=(0,J.isUndefined)(yt)?0:+yt,Nt=(0,J.isUndefined)(Zt)?0:+Zt,kt="".concat(+mt+ +gt-(+Pt+ +bt+ +Nt));return(0,ie.jsxs)(ie.Fragment,{children:[P,(0,ie.jsxs)(O.Z,{form:y,name:"control-contract-edit-ref",ref:g,layout:"vertical",initialValues:u,onFinish:ot(function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,c,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=(0,r.Z)((0,r.Z)({},t),{},{contractPriceItems:ue,servicesArisingItems:U,contractImage:$e,customerType:(null===t||void 0===t?void 0:t.customerType)||"offline",servicesArising:(0,J.map)(U,(function(e){return null===e||void 0===e?void 0:e.value}))||[],createDate:C()(t.createDate).toISOString(),dueDate:C()(t.dueDate).toISOString(),shootingDate:C()(t.shootingDate).toISOString(),firstDepositPriceDate:C()(t.firstDepositPriceDate).toISOString(),secondDepositPriceDate:C()(t.secondDepositPriceDate).toISOString(),notes:(0,J.isArray)(null===t||void 0===t?void 0:t.notes)?null===t||void 0===t?void 0:t.notes:[null===t||void 0===t?void 0:t.notes],totalPrice:"".concat(+mt+ +gt-+Pt)}),l=(0,q.JU)(We,u.id),(0,q.r7)(l,c).then((0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:case"end":return e.stop()}}),e)})))),He.invalidateQueries("contract"),T(!0),j.open({type:"success",content:"C\u1eadp nh\u1eadp h\u1ee3p \u0111\u1ed3ng th\xe0nh c\xf4ng!",duration:5}),T(!1),null===v||void 0===v||v(),y.resetFields(),null===(n=g.current)||void 0===n||n.resetFields(),ct();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),children:[(0,ie.jsxs)("div",{className:"grid grid-cols-1",children:[(0,ie.jsx)(h.Z,{title:"Nh\u1eadp s\u1ed1 l\u01b0\u1ee3ng",open:ze,description:(0,ie.jsxs)("div",{className:"flex gap-2",children:[(0,ie.jsx)(a.Z,{type:"number",min:1,value:Ee,onChange:function(e){return Ae(parseInt(e.target.value))}}),(0,ie.jsx)(z.Z,{defaultValue:0,value:Le,style:{width:"100%"},placeholder:"Nh\u1eadp discount",onChange:function(e){return Be(e)},formatter:function(e){return"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")}})]}),onConfirm:function(){var e=(0,J.map)(ue,(function(e){return e.key===(0,N.$5)("".concat(Ie))?(0,r.Z)((0,r.Z)({},e),{},{quantity:Ee,discount:Le}):e}));qe(null),he(e),Ae(1),Be(0),Re(!1)},onCancel:function(){return Re(!1)},okText:"Th\xeam",cancelText:"Hu\u1ef7",children:" "}),(0,ie.jsx)($.x,{control:it,name:"contractType",label:"Lo\u1ea1i h\u1ee3p \u0111\u1ed3ng",children:(0,ie.jsx)(R.Z,{mode:"multiple",defaultValue:at,showSearch:!0,style:{width:"100%"},placeholder:"Ch\u1ecdn lo\u1ea1i h\u1ee3p \u0111\u1ed3ng",options:vt,onDeselect:function(e){he((0,J.filter)(ue,(function(t){return(null===t||void 0===t?void 0:t.value)!==e})))},onSelect:function(e){var t=(0,J.find)(ue,{value:e}),n={key:(0,N.$5)("".concat(e)),value:e,label:e,quantity:(null===t||void 0===t?void 0:t.quantity)||ye,discount:(null===t||void 0===t?void 0:t.discount)||Le};if((null===t||void 0===t?void 0:t.quantity)&&Ae(null===t||void 0===t?void 0:t.quantity),(null===t||void 0===t?void 0:t.discount)&&Be(null===t||void 0===t?void 0:t.discount),qe(e),!t){var i=(0,J.find)(tt,{contractName:null===n||void 0===n?void 0:n.value});he([].concat((0,V.Z)(ue),[(0,r.Z)((0,r.Z)({},n),{},{price:(null===i||void 0===i?void 0:i.contractPrice)||0})]))}Re(!0)}})}),(0,ie.jsx)(h.Z,{title:"Nh\u1eadp s\u1ed1 l\u01b0\u1ee3ng v\xe0 discount",open:Ce,description:(0,ie.jsxs)("div",{className:"flex gap-2",children:[(0,ie.jsx)(a.Z,{type:"number",min:1,value:ye,onChange:function(e){return Ze(parseInt(e.target.value))}}),(0,ie.jsx)(z.Z,{defaultValue:0,value:Pe,style:{width:"100%"},placeholder:"Nh\u1eadp discount",onChange:function(e){return be(e)},formatter:function(e){return"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")}})]}),onConfirm:function(){var e=(0,J.map)(U,(function(e){return e.key===(0,N.$5)("".concat(fe))?(0,r.Z)((0,r.Z)({},e),{},{quantity:ye,discount:Pe}):e}));me(null),ae(e),Ze(1),be(0),we(!1)},onCancel:function(){return we(!1)},okText:"Th\xeam",cancelText:"Hu\u1ef7"}),(0,ie.jsx)($.x,{control:it,name:"servicesArising",label:"Danh m\u1ee5c ph\xe1t sinh",children:(0,ie.jsx)(R.Z,{mode:"multiple",defaultValue:pt,showSearch:!0,style:{width:"100%"},placeholder:"Ch\u1ecdn danh m\u1ee5c ph\xe1t sinh",options:ht,onDeselect:function(e){ae((0,J.filter)(U,(function(t){return(null===t||void 0===t?void 0:t.value)!==e})))},onSelect:function(e){var t=(0,J.find)(U,{value:e}),n={key:(0,N.$5)("".concat(e)),value:e,label:e,quantity:(null===t||void 0===t?void 0:t.quantity)||ye,discount:(null===t||void 0===t?void 0:t.discount)||Le};if((null===t||void 0===t?void 0:t.quantity)&&Ze(null===t||void 0===t?void 0:t.quantity),(null===t||void 0===t?void 0:t.discount)&&be(null===t||void 0===t?void 0:t.discount),me(e),!t){var i=(0,J.find)(et,{serviceName:null===n||void 0===n?void 0:n.value});ae([].concat((0,V.Z)(U),[(0,r.Z)((0,r.Z)({},n),{},{price:(null===i||void 0===i?void 0:i.servicePrice)||0})]))}we(!0)}})}),(0,ie.jsx)($.x,{control:it,name:"status",label:"Tr\u1ea1ng th\xe1i",children:(0,ie.jsx)(R.Z,{children:ce.map((function(e,t){return(0,ie.jsx)(R.Z.Option,{value:e,children:(0,ie.jsx)(d.Z,{color:(0,N.z2)("".concat(e).toLowerCase()||"pending"),text:(0,J.capitalize)(e)})},t)}))})})]}),(0,ie.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 xl:gap-6",children:[(0,ie.jsx)($.x,{control:it,name:"userName",label:"T\xean kh\xe1ch h\xe0ng",children:(0,ie.jsx)(a.Z,{allowClear:!0,placeholder:"Nh\u1eadp t\xean kh\xe1ch h\xe0ng"})}),(0,ie.jsx)($.x,{control:it,name:"phone",label:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i",children:(0,ie.jsx)(a.Z,{placeholder:"Nh\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i"})}),(0,ie.jsx)($.x,{control:it,name:"address",label:"\u0110\u1ecba ch\u1ec9",children:(0,ie.jsx)(a.Z,{placeholder:"Nh\u1eadp \u0111\u1ecba ch\u1ec9"})})]}),(0,ie.jsx)($.x,{control:it,name:"contractPrice",label:"Gi\xe1 h\u1ee3p \u0111\u1ed3ng",children:(0,ie.jsx)(z.Z,{disabled:!0,style:{width:"100%"},placeholder:"Nh\u1eadp gi\xe1 h\u1ee3p \u0111\u1ed3ng",formatter:function(e){return"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")}})}),(0,ie.jsx)("div",{className:(0,ee.cn)(!Qe&&"hidden"),children:(0,ie.jsx)($.x,{control:it,name:"servicesArisingPrice",label:"Gi\xe1 m\u1ee5c ph\xe1t sinh",valuePropName:"value",children:(0,ie.jsx)(z.Z,{disabled:!0,style:{width:"100%"},placeholder:"Gi\xe1 m\u1ee5c ph\xe1t sinh",formatter:function(e){return"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")}})})}),(0,ie.jsx)($.x,{control:it,name:"discount",label:"T\u1ed5ng discount",valuePropName:"value",children:(0,ie.jsx)(z.Z,{style:{width:"100%"},placeholder:"Gi\xe1 discount",formatter:function(e){return"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")}})}),(0,ie.jsx)("div",{className:"pb-6",children:(0,ie.jsxs)(p.Z,{children:[(0,ie.jsx)("span",{className:"text-lg font-semibold text-gray-900",children:"Th\xe0nh ti\u1ec1n:"}),(0,ie.jsx)("span",{className:"text-lg font-semibold text-blue-600",children:(0,N.xG)("".concat(+mt+ +gt))})]})}),(0,ie.jsx)("div",{className:"pb-6",children:(0,ie.jsxs)(p.Z,{children:[(0,ie.jsx)("span",{className:"text-lg font-semibold text-gray-900",children:"Thanh to\xe1n c\xf2n l\u1ea1i:"}),(0,ie.jsx)("span",{className:"text-lg font-semibold text-blue-600",children:(0,N.xG)("".concat(kt))})]})}),(0,ie.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 xl:gap-6",children:[(0,ie.jsx)($.x,{control:it,name:"createDate",label:"Ng\xe0y k\xfd h\u1ee3p \u0111\u1ed3ng",children:(0,ie.jsx)(W.Z,{format:re,placeholder:"Vui l\xf2ng ch\u1ecdn ng\xe0y k\xfd h\u1ee3p \u0111\u1ed3ng",style:{width:"100%"}})}),(0,ie.jsx)($.x,{control:it,name:"shootingDate",label:"Ng\xe0y b\u1ea5m m\xe1y",children:(0,ie.jsx)(W.Z,{format:re,placeholder:"Vui l\xf2ng ch\u1ecdn ng\xe0y b\u1ea5m m\xe1y",style:{width:"100%"}})}),(0,ie.jsx)($.x,{control:it,name:"dueDate",label:"Ng\xe0y d\u1ef1 ki\u1ebfn",children:(0,ie.jsx)(W.Z,{format:re,placeholder:"Vui l\xf2ng ch\u1ecdn ng\xe0y ho\xe0n th\xe0nh h\u1ee3p \u0111\u1ed3ng",style:{width:"100%"}})}),(0,ie.jsx)($.x,{control:it,name:"customerType",label:"K\xeanh kh\xe1ch h\xe0ng",children:(0,ie.jsxs)(Y.ZP.Group,{optionType:"button",buttonStyle:"solid",children:[(0,ie.jsx)(Y.ZP.Button,{value:"online",children:"Online"}),(0,ie.jsx)(Y.ZP.Button,{value:"offline",children:"Offline"})]})})]}),(0,ie.jsx)("div",{className:"py-6",children:(0,ie.jsx)($.x,{control:it,name:"contractImage",label:"Upload h\xecnh \u1ea3nh h\u1ee3p \u0111\u1ed3ng",children:(0,ie.jsxs)(oe,(0,r.Z)((0,r.Z)({},ut),{},{children:[(0,ie.jsx)("p",{className:"ant-upload-drag-icon",children:(0,ie.jsx)(E.Z,{})}),(0,ie.jsx)("p",{className:"ant-upload-text",children:"Nh\u1ea5p ho\u1eb7c k\xe9o t\u1ec7p v\xe0o khu v\u1ef1c n\xe0y \u0111\u1ec3 t\u1ea3i l\xean"}),(0,ie.jsx)("p",{className:"ant-upload-hint",children:"H\u1ed7 tr\u1ee3 t\u1ea3i l\xean m\u1ed9t l\u1ea7n ho\u1eb7c h\xe0ng lo\u1ea1t. Nghi\xeam c\u1ea5m t\u1ea3i l\xean d\u1eef li\u1ec7u c\xf4ng ty ho\u1eb7c c\xe1c th\xf4ng tin kh\xe1c"})]}))})}),(0,ie.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 xl:gap-6 pb-6",children:[(0,ie.jsx)(F.Z,{size:"small",title:"C\u1ecdc l\u1ea7n 1",extra:(0,ie.jsx)($.x,{style:{marginBottom:0},control:it,name:"firstCheckDeposit",valuePropName:"checked",children:(0,ie.jsx)(L.Z,{})}),children:(0,ie.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 xl:gap-6 pb-6",children:[(0,ie.jsx)($.x,{control:it,name:"firstDepositPrice",label:"Ti\u1ec1n c\u1ecdc l\u1ea7n 1",children:(0,ie.jsx)(z.Z,{disabled:!Dt,style:{width:"100%"},placeholder:"Nh\u1eadp ti\u1ec1n c\u1ecdc l\u1ea7n 1",formatter:function(e){return"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")}})}),(0,ie.jsx)($.x,{control:it,name:"firstDepositPriceDate",label:"Ng\xe0y c\u1ecdc l\u1ea7n 1",children:(0,ie.jsx)(W.Z,{disabled:!Dt,format:re,placeholder:"Vui l\xf2ng ch\u1ecdn ng\xe0y c\u1ecdc l\u1ea7n 1",style:{width:"100%"}})}),(0,ie.jsx)($.x,{control:it,name:"firstPaymentMethod",label:"Ph\u01b0\u01a1ng th\u1ee9c thanh to\xe1n",children:(0,ie.jsx)(R.Z,{style:{width:140},disabled:!Dt,options:[{value:"Chuy\u1ec3n kho\u1ea3n",label:"Chuy\u1ec3n kho\u1ea3n"},{value:"Ti\u1ec1n m\u1eb7t",label:"Ti\u1ec1n m\u1eb7t"}]})})]})}),(0,ie.jsx)(F.Z,{size:"small",title:"C\u1ecdc l\u1ea7n 2",extra:(0,ie.jsx)($.x,{style:{marginBottom:0},control:it,name:"secondCheckDeposit",valuePropName:"checked",children:(0,ie.jsx)(L.Z,{})}),children:(0,ie.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 xl:gap-6 pb-6",children:[(0,ie.jsx)($.x,{control:it,name:"secondDepositPrice",label:"Ti\u1ec1n c\u1ecdc l\u1ea7n 2",children:(0,ie.jsx)(z.Z,{disabled:!jt,style:{width:"100%"},placeholder:"Nh\u1eadp ti\u1ec1n c\u1ecdc l\u1ea7n 2",formatter:function(e){return"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")}})}),(0,ie.jsx)($.x,{control:it,name:"secondDepositPriceDate",label:"Ng\xe0y c\u1ecdc l\u1ea7n 2",children:(0,ie.jsx)(W.Z,{disabled:!jt,format:re,placeholder:"Vui l\xf2ng ch\u1ecdn ng\xe0y c\u1ecdc l\u1ea7n 2",style:{width:"100%"}})}),(0,ie.jsx)($.x,{control:it,name:"secondPaymentMethod",label:"Ph\u01b0\u01a1ng th\u1ee9c thanh to\xe1n",children:(0,ie.jsx)(R.Z,{style:{width:140},disabled:!jt,options:[{value:"Chuy\u1ec3n kho\u1ea3n",label:"Chuy\u1ec3n kho\u1ea3n"},{value:"Ti\u1ec1n m\u1eb7t",label:"Ti\u1ec1n m\u1eb7t"}]})})]})})]}),(0,ie.jsx)("div",{className:"pb-20 ",children:(0,ie.jsx)($.x,{control:it,name:"notes",label:"Ghi ch\xfa",children:(0,ie.jsx)(_.Z,{})})}),(0,ie.jsx)(f.ZP,{loading:w,disabled:!(0,J.isEmpty)(rt),type:"primary",htmlType:"submit",block:!0,size:"large",children:"C\u1eadp nh\u1eadt"})]})]})}var se=n(99995),de=(C()(),function(){var e=(0,l.useState)(""),t=(0,c.Z)(e,2),n=t[0],x=t[1],k=(0,l.useState)(""),V=(0,c.Z)(k,2),E=V[0],A=V[1],Y=(0,l.useRef)(null),F=(0,S.useQueryClient)(),L=(0,I.c)(),B=L.data,O=(L.isLoading,L.refetch),G=(L.isFetching,(0,q.hJ)(M.R,"contract")),z=(0,l.useState)(!1),R=(0,c.Z)(z,2),W=R[0],H=R[1],Q=(0,te.a)().user,U=(null===Q||void 0===Q?void 0:Q.permission)||"",$=(null===Q||void 0===Q?void 0:Q.permissions)||{},_=(0,l.useState)(null),X=(0,c.Z)(_,2),ee=X[0],ne=X[1],oe=(0,l.useState)({contractType:"",dressName:"",status:"",phone:"",address:"",createDate:"",dueDate:"",shottingDate:"",contractPrice:"",notes:[],contractImage:[],discount:"",contractTypeValuePrice:[],firstCheckDeposit:!1,firstDepositPrice:"",firstDepositPriceDate:"",secondCheckDeposit:!1,secondDepositPrice:"",secondDepositPriceDate:"",shootingDate:"",totalPrice:"",userName:"",servicesArisingPrice:"",firstPaymentMethod:"",secondPaymentMethod:"",servicesArisingItems:void 0,contractPriceItems:void 0,totalContractPrice:"",servicesArising:[],id:""}),re=(0,c.Z)(oe,2),ce=re[0],le=re[1],de=(0,l.useMemo)((function(){return(0,J.uniq)((null!==B&&void 0!==B?B:[]).map((function(e){var t;return(null!==(t=e.status)&&void 0!==t?t:"").trim()})).filter(Boolean)).map((function(e){return{text:e,value:e}}))}),[B]),ue=function(e,t,n){t(),x(e[0]),A(n)},he=function(e){return function(){le((0,r.Z)((0,r.Z)({},e),{},{createDate:C()(e.createDate),dueDate:C()(e.dueDate),shootingDate:C()(e.shootingDate),firstDepositPriceDate:(0,J.isEmpty)(e.firstDepositPriceDate)?void 0:C()(e.firstDepositPriceDate),secondDepositPriceDate:(0,J.isEmpty)(e.secondDepositPriceDate)?void 0:C()(e.secondDepositPriceDate)})),H(!0)}},ve=function(){H(!1)},pe=function(e){return(0,o.Z)((0,i.Z)().mark((function t(){var n;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,q.JU)(G,null===e||void 0===e?void 0:e.id),t.next=3,(0,q.oe)(n);case 3:F.invalidateQueries("contract"),setTimeout((0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),300);case 5:case"end":return t.stop()}}),t)})))},fe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contractType";return{filterDropdown:function(t){var n=t.setSelectedKeys,i=t.selectedKeys,o=t.confirm,r=t.clearFilters,c=t.close;return(0,ie.jsxs)("div",{style:{padding:8},onKeyDown:function(e){return e.stopPropagation()},children:[(0,ie.jsx)(a.Z,{ref:Y,placeholder:"Search ".concat(e),value:i[0],onChange:function(e){return n(e.target.value?[e.target.value]:[])},onPressEnter:function(){return ue(i,o,e)},style:{marginBottom:8,display:"block"}}),(0,ie.jsxs)(p.Z,{children:[(0,ie.jsx)(f.ZP,{type:"primary",onClick:function(){return ue(i,o,e)},icon:(0,ie.jsx)(Z.Z,{}),size:"small",style:{width:90},children:"Search"}),(0,ie.jsx)(f.ZP,{onClick:function(){r&&(!function(e){e(),x("")}(r),setTimeout((function(){ue(i,o,e)}),100))},size:"small",style:{width:90},children:"Reset"}),(0,ie.jsx)(f.ZP,{type:"link",size:"small",onClick:function(){o({closeDropdown:!1}),x(i[0]),A(e)},children:"Filter"}),(0,ie.jsx)(f.ZP,{type:"link",size:"small",onClick:function(){c()},children:"close"})]})]})},filterIcon:function(e){return(0,ie.jsx)(Z.Z,{style:{color:e?"#1677ff":void 0}})},onFilter:function(t,n){var i,o,r,c,l;return"createDate"===e||"shootingDate"===e?C()(n[e]).format("DD/MM/YYYY").toString().includes(t):null===(i=n[e])||void 0===i||null===(o=i.toString())||void 0===o||null===(r=o.toLowerCase())||void 0===r||null===(c=r.includes)||void 0===c?void 0:c.call(r,null===t||void 0===t||null===(l=t.toLowerCase)||void 0===l?void 0:l.call(t))},onFilterDropdownOpenChange:function(e){e&&setTimeout((function(){var e;return null===(e=Y.current)||void 0===e?void 0:e.select()}),100)},render:function(i,o){var r,c;return"contractType"!==t?(0,ie.jsx)(ie.Fragment,{children:E===e?(0,ie.jsx)(y(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[n],autoEscape:!0,textToHighlight:i?"createDate"===t||"shootingDate"===t?C()(i).format("DD/MM/YYYY").toString():i.toString():""}):"createDate"===t||"shootingDate"===t?C()(i).format("DD/MM/YYYY"):i}):(0,ie.jsxs)("div",{className:"flex flex-col gap-2 items-center",children:[(null===o||void 0===o?void 0:o.contractImage.length)>0?(0,ie.jsx)("div",{className:"overflow-hidden rounded-lg drop-shadow-lg w-[40px] h-[40px]",children:(0,ie.jsx)(s.Z.PreviewGroup,{items:(0,J.map)(null===o||void 0===o?void 0:o.contractImage,"url"),children:(0,ie.jsx)(s.Z,{src:null===(r=o.contractImage)||void 0===r||null===(c=r[0])||void 0===c?void 0:c.url,width:40,height:40,preview:{mask:(0,ie.jsx)(P.Zju,{})}})})}):null,E===e?(0,ie.jsx)(y(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[n],autoEscape:!0,textToHighlight:i?null===i||void 0===i?void 0:i.toString():""}):(0,ie.jsx)("p",{className:"font-semibold text-base",children:i})]})}}},me=[(0,r.Z)({title:"T\xean h\u1ee3p \u0111\u1ed3ng",dataIndex:"contractType",key:"contractType",fixed:"left",width:"20%"},fe("contractType","contractType")),{title:"Tr\u1ea1ng th\xe1i",dataIndex:"status",key:"status",filters:de,filterMultiple:!0,filterSearch:!0,onFilter:function(e,t){var n;return(null!==(n=t.status)&&void 0!==n?n:"").toLowerCase()===String(e).toLowerCase()},filteredValue:null!==ee&&void 0!==ee?ee:null,render:function(e){return(0,ie.jsx)(d.Z,{color:(0,N.z2)("".concat(e).toLowerCase()||"pending"),text:e})}},{title:"T\xean kh\xe1ch h\xe0ng",dataIndex:"userName",key:"userName",sorter:function(e,t){return e.userName.localeCompare(t.userName)},sortDirections:["descend","ascend"]},{title:"K\xeanh KH",dataIndex:"customerType",key:"customerType",sortDirections:["descend","ascend"],render:function(e,t){return console.log("text, ",e),(0,ie.jsx)(d.Z,{color:(0,N.Dw)("".concat((null===t||void 0===t?void 0:t.customerType)||"offline").toLowerCase()||"offline"),text:(null===t||void 0===t?void 0:t.customerType)||"--"})}},(0,r.Z)({title:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i",dataIndex:"phone",key:"phone"},fe("phone","phone")),{title:"Gi\xe1",dataIndex:"totalPrice",key:"totalPrice",sorter:function(e,t){return e.totalPrice.localeCompare(t.totalPrice)},sortDirections:["descend","ascend"],render:function(e){return(0,ie.jsx)("p",{children:(0,N.xG)(e)})}},{title:"\u0110\u1ecba ch\u1ec9",dataIndex:"address",key:"address"},(0,r.Z)({title:"Ng\xe0y k\xfd h\u1ee3p \u0111\u1ed3ng",dataIndex:"createDate",key:"createDate",sorter:function(e,t){return e.createDate.localeCompare(t.createDate)},sortDirections:["descend","ascend"]},fe("createDate","createDate")),(0,r.Z)({title:"Ng\xe0y ng\xe0y b\u1ea5m m\xe1y",dataIndex:"shootingDate",key:"shootingDate",sorter:function(e,t){return e.shootingDate.localeCompare(t.shootingDate)},sortDirections:["descend","ascend"]},fe("shootingDate","shootingDate")),{title:"Ng\xe0y ho\xe0n th\xe0nh",dataIndex:"dueDate",key:"dueDate",sorter:function(e,t){return e.dueDate.localeCompare(t.dueDate)},sortDirections:["descend","ascend"],render:function(e){return(0,ie.jsx)("p",{children:C()(e).format("DD/MM/YYYY")})}},{title:"Ch\u1ec9nh s\u1eeda",dataIndex:"editDelete",key:"editDelete",fixed:"right",width:"10%",render:function(e,t){return(0,ie.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ie.jsx)(u.Z,{title:"In h\u1ee3p \u0111\u1ed3ng",children:(0,ie.jsx)(se.t,{getValues:ge(t)})}),(0,N.J5)($,"contracts")&&(0,ie.jsx)(u.Z,{title:"Ch\u1ec9nh s\u1eeda",children:(0,ie.jsx)(w.Z,{override:T.O.primary,type:"primary",size:"small",icon:(0,ie.jsx)(j.fmQ,{}),onClick:he(t)})}),(0,N.k7)($,"contracts")&&(0,ie.jsx)(u.Z,{title:"Xo\xe1",children:(0,ie.jsx)(h.Z,{title:"X\xf3a h\u1ee3p \u0111\u1ed3ng",description:"B\u1ea1n c\xf3 ch\u1eafc l\xe0 mu\u1ed1n x\xf3a h\u1ee3p \u0111\u1ed3ng?",icon:(0,ie.jsx)(D.Z,{style:{color:T.O.red2}}),onConfirm:pe(t),children:(0,ie.jsx)(w.Z,{override:T.O.red2,type:"primary",size:"small",disabled:"admin"!==U,icon:(0,ie.jsx)(b.FH3,{})})})})]})}}],ge=function(e){return function(){return(0,r.Z)({},e)}};return(0,ie.jsxs)("div",{className:"m-6 p-2 md:p-10 bg-white rounded-3xl",children:[(0,ie.jsx)("div",{className:"mb-4",children:(0,ie.jsx)(m.Z,{items:[{href:"/",title:"Trang ch\u1ee7"},{title:"Danh s\xe1ch h\u1ee3p \u0111\u1ed3ng"}]})}),(0,ie.jsx)(g.Z,{rowKey:function(e){return"".concat((0,K.Z)(),"-").concat(e.id)},columns:me,dataSource:B,onChange:function(e,t){var n;return ne(null!==(n=t.status)&&void 0!==n?n:null)},bordered:!0,scroll:{x:1300}}),(0,ie.jsx)(v.Z,{title:"C\u1eadp nh\u1eadt h\u1ee3p \u0111\u1ed3ng",open:W,footer:null,onCancel:ve,width:1e3,bodyStyle:{overflowY:"scroll",height:"calc(100vh - 250px)"},children:(0,ie.jsx)(ae,{defaultValues:ce,handleCancel:ve,refetch:O})})]})})}}]);
//# sourceMappingURL=9910.f10fbf32.chunk.js.map