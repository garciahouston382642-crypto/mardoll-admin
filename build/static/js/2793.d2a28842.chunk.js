"use strict";(self.webpackChunkmardoll_admin=self.webpackChunkmardoll_admin||[]).push([[2793],{47701:function(e,n,t){t.d(n,{x:function(){return d}});var l=t(1413),i=t(44925),r=(t(72791),t(93070)),a=t(61134),o=t(80184),u=["children","control","name","help","hasFeedback"],d=function(e){var n,t,d=e.children,c=e.control,s=e.name,f=e.help,h=e.hasFeedback,v=void 0!==h&&h,p=(0,i.Z)(e,u),m=(0,a.bc)({name:s,control:c}),g=m.field,Z=m.fieldState,y=m.formState.errors;return(0,o.jsx)(r.Z.Item,(0,l.Z)((0,l.Z)({hasFeedback:v,name:s,normalize:function(e){return g.onChange(e),e},validateStatus:Z.invalid?"error":void 0,help:null!==(n=null===(t=y[s])||void 0===t?void 0:t.message)&&void 0!==n?n:f},p),{},{children:d}))}},16196:function(e,n,t){t.d(n,{Z:function(){return S}});var l=t(4942),i=t(1413),r=t(74165),a=t(93433),o=t(15861),u=t(29439),d=t(72791),c=t(72351),s=t(66776),f=t(44695),h=t(93070),v=t(4206),p=t(71439),m=t(2641),g=t(86005),Z=t(54941),y=t(12481),x=t(30276),w=t(763),b=t(61134),k=t(91933),j=t(54261),F=t(8007),E=t(54174),C=t(47701),P=t(20028),I=t(80184),R=F.Ry({title:F.Z_().required("Vui l\xf2ng nh\u1eadp ti\xeau \u0111\u1ec1 gi\u1edbi thi\u1ec7u!"),description:F.Z_(),gallery:F.nK().required("Vui l\xf2ng upload file h\xecnh \u1ea3nh").test("fileEmpty","Vui l\xf2ng upload file h\xecnh \u1ea3nh",(function(e){return 0!==(null===e||void 0===e?void 0:e.length)})),url:F.nK().required("Vui l\xf2ng upload file h\xecnh \u1ea3nh").test("fileEmpty","Vui l\xf2ng upload file h\xecnh \u1ea3nh",(function(e){return 0!==(null===e||void 0===e?void 0:e.length)}))}).required();function S(e){var n,t=e.type,F=void 0===t?"album":t,S=e.data,T=e.file,V=e.handleCancel,L=(e.refetch,{album:"albumPhoto",reportage:"weddingDayReportage"}),N=(0,w.find)(null===S||void 0===S||null===(n=S[L[F]])||void 0===n?void 0:n.gallery,{id:null===T||void 0===T?void 0:T.id})||{};console.log("albumPhotoItem",N);var D={id:(0,j.Z)(),uid:(0,j.Z)(),status:"done",url:null===N||void 0===N?void 0:N.url,name:null===N||void 0===N?void 0:N.name,alt:null===N||void 0===N?void 0:N.alt},q=(0,d.useRef)(null),B=h.Z.useForm(),U=(0,u.Z)(B,1)[0],_=v.ZP.useMessage(),O=(0,u.Z)(_,2),A=O[0],J=O[1],H=(0,d.useState)(!1),M=(0,u.Z)(H,2),z=M[0],K=M[1],Q=(0,d.useState)([]),X=(0,u.Z)(Q,2),G=X[0],W=X[1],Y=(0,d.useState)([D]),$=(0,u.Z)(Y,2),ee=$[0],ne=$[1],te=(0,y.hJ)(E.R,"servicePage"),le=(0,P.b)(te),ie=((0,k.useQueryClient)(),{title:(null===N||void 0===N?void 0:N.title)||"",description:(null===N||void 0===N?void 0:N.description)||"",gallery:(null===N||void 0===N?void 0:N.gallery)||[],url:[D]}),re=(0,b.cI)({defaultValues:ie,resolver:(0,f.X)(R)}),ae=re.control,oe=re.handleSubmit,ue=re.formState.errors,de=re.reset,ce=re.setValue;(0,d.useEffect)((function(){U.setFieldsValue({title:(null===N||void 0===N?void 0:N.title)||"",description:(null===N||void 0===N?void 0:N.description)||"",gallery:(null===N||void 0===N?void 0:N.gallery)||[],url:[D]}),W((null===N||void 0===N?void 0:N.gallery)||[]),ne([D]||0)}),[N,U]);var se=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"done"===n.file.status?(W((function(e){return[].concat((0,a.Z)(e),[{id:(0,j.Z)(),url:n.file.url,name:n.file.name,alt:n.file.name.substr(0,n.file.name.lastIndexOf("."))}])})),ce("gallery",[].concat((0,a.Z)(G),[{id:(0,j.Z)(),url:n.file.url,name:n.file.name,alt:n.file.name.substr(0,n.file.name.lastIndexOf("."))}])),v.ZP.success("".concat(n.file.name," file uploaded successfully"))):"error"===n.file.status&&v.ZP.error("".concat(n.file.name," file upload failed."));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),fe=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){var t,l,i,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.file,l=n.onSuccess,i=n.onError;try{(a=new FileReader).readAsDataURL(t),a.onload=function(e){var n=new Image;n.src=e.target.result,n.onload=function(){var e,i,r=n.width/n.height;n.width>800||n.height>800?r>1?(e=800,i=800/r):(e=800*r,i=800):(e=n.width,i=n.height);var a=document.createElement("canvas"),o=a.getContext("2d");a.width=e,a.height=i,o.drawImage(n,0,0,e,i),a.toBlob((function(e){var n=new File([e],t.name,{type:t.type}),i=(0,x.iH)(E.t,"/manager-page/".concat(n.name)),r=(0,x.B0)(i,n);r.on("state_changed",(function(e){Math.round(e.bytesTransferred/e.totalBytes*100)}),(function(e){return console.log(e)}),(function(){(0,x.Jt)(r.snapshot.ref).then((function(e){l(),se({file:{status:"done",name:n.name,url:e}})}))}))}),t.type)}}}catch(r){console.error("Error uploading file:",r),i()}case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),he={name:"file",multiple:!0,listType:"picture-card",customRequest:fe,onChange:function(e){var n=e.fileList;if(G.length>0){var t=null===G||void 0===G?void 0:G.reduce((function(e,t){return n.some((function(e){var n;return null===t||void 0===t||null===(n=t.id)||void 0===n?void 0:n.includes(null===e||void 0===e?void 0:e.id)}))&&e.push(t),e}),[]);W(t),ce("gallery",t)}},fileList:G,onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)}},ve=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"done"===n.file.status?(ne([{id:(0,j.Z)(),url:n.file.url,name:n.file.name,alt:n.file.name.substr(0,n.file.name.lastIndexOf("."))}]),ce("url",[{id:(0,j.Z)(),url:n.file.url,name:n.file.name,alt:n.file.name.substr(0,n.file.name.lastIndexOf("."))}]),v.ZP.success("".concat(n.file.name," file uploaded successfully"))):"error"===n.file.status&&v.ZP.error("".concat(n.file.name," file upload failed."));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),pe=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){var t,l,i,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.file,l=n.onSuccess,i=n.onError;try{(a=new FileReader).readAsDataURL(t),a.onload=function(e){var n=new Image;n.src=e.target.result,n.onload=function(){var e,i,r=n.width/n.height;n.width>800||n.height>800?r>1?(e=800,i=800/r):(e=800*r,i=800):(e=n.width,i=n.height);var a=document.createElement("canvas"),o=a.getContext("2d");a.width=e,a.height=i,o.drawImage(n,0,0,e,i),a.toBlob((function(e){var n=new File([e],t.name,{type:t.type}),i=(0,x.iH)(E.t,"/manager-page/".concat(n.name)),r=(0,x.B0)(i,n);r.on("state_changed",(function(e){Math.round(e.bytesTransferred/e.totalBytes*100)}),(function(e){return console.log(e)}),(function(){(0,x.Jt)(r.snapshot.ref).then((function(e){l(),ve({file:{status:"done",name:n.name,url:e}})}))}))}),t.type)}}}catch(r){console.error("Error uploading file:",r),i()}case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),me={name:"file",multiple:!1,listType:"picture",customRequest:pe,onChange:function(e){var n=e.fileList;if(G.length>0){var t=null===ee||void 0===ee?void 0:ee.reduce((function(e,t){return n.some((function(e){var n;return null===t||void 0===t||null===(n=t.id)||void 0===n?void 0:n.includes(null===e||void 0===e?void 0:e.id)}))&&e.push(t),e}),[]);ne(t),ce("url",t)}},fileList:ee,onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)}};return(0,I.jsxs)(I.Fragment,{children:[J,(0,I.jsxs)(h.Z,{form:U,name:"control-service-edit-ref",ref:q,layout:"vertical",initialValues:ie,onFinish:oe(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){var t,a,o,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=(0,w.map)(null===S||void 0===S||null===(t=S.albumPhoto)||void 0===t?void 0:t.gallery,(function(e){var t,l,i,r;return e.id===T.id?(0,w.assign)({},e,{name:(null===ee||void 0===ee||null===(t=ee[0])||void 0===t?void 0:t.name)||(null===ee||void 0===ee||null===(l=ee[0])||void 0===l?void 0:l.url),alt:(null===ee||void 0===ee||null===(i=ee[0])||void 0===i?void 0:i.alt)||"",url:(null===ee||void 0===ee||null===(r=ee[0])||void 0===r?void 0:r.url)||"",title:null===n||void 0===n?void 0:n.title,description:null===n||void 0===n?void 0:n.description,gallery:G}):e})),u=(0,i.Z)((0,i.Z)({},S),{},(0,l.Z)({},L[F],(0,i.Z)((0,i.Z)({},null===S||void 0===S?void 0:S[L[F]]),{},{gallery:o}))),le.mutate(u),K(!0),A.open({type:"success",content:"C\u1eadp nh\u1eadp th\xe0nh c\xf4ng!",duration:5}),K(!1),null===V||void 0===V||V(),U.resetFields(),null===(a=q.current)||void 0===a||a.resetFields(),de();case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),children:[(0,I.jsx)(C.x,{control:ae,name:"url",label:"Upload h\xecnh ch\xednh v\u1ee5",children:(0,I.jsx)(p.Z,(0,i.Z)((0,i.Z)({},me),{},{children:(0,I.jsx)(m.ZP,{icon:(0,I.jsx)(c.Z,{}),children:"Upload"})}))}),(0,I.jsx)(C.x,{hasFeedback:!1,control:ae,name:"title",label:"Ti\xeau \u0111\u1ec1",children:(0,I.jsx)(g.Z.TextArea,{allowClear:!0,placeholder:"Nh\u1eadp ti\xeau \u0111\u1ec1 d\u1ecbch v\u1ee5"})}),(0,I.jsx)(C.x,{hasFeedback:!1,control:ae,name:"description",label:"N\u1ed9i dung",children:(0,I.jsx)(g.Z.TextArea,{allowClear:!0,placeholder:"Nh\u1eadp n\u1ed9i dung"})}),(0,I.jsx)(C.x,{control:ae,name:"gallery",label:"Upload h\xecnh banner header",children:(0,I.jsxs)(Z.Z,(0,i.Z)((0,i.Z)({},he),{},{children:[(0,I.jsx)("p",{className:"ant-upload-drag-icon",children:(0,I.jsx)(s.Z,{})}),(0,I.jsx)("p",{className:"ant-upload-text",children:"Nh\u1ea5p ho\u1eb7c k\xe9o t\u1ec7p v\xe0o khu v\u1ef1c n\xe0y \u0111\u1ec3 t\u1ea3i l\xean"}),(0,I.jsx)("p",{className:"ant-upload-hint",children:"H\u1ed7 tr\u1ee3 t\u1ea3i l\xean m\u1ed9t l\u1ea7n ho\u1eb7c h\xe0ng lo\u1ea1t. Nghi\xeam c\u1ea5m t\u1ea3i l\xean d\u1eef li\u1ec7u c\xf4ng ty ho\u1eb7c c\xe1c th\xf4ng tin kh\xe1c"})]}))}),(0,I.jsx)(m.ZP,{loading:z,disabled:!(0,w.isEmpty)(ue),type:"primary",htmlType:"submit",block:!0,size:"large",children:"C\u1eadp nh\u1eadt"})]})]})}},17384:function(e,n,t){t.d(n,{U:function(){return d}});var l=t(74165),i=t(15861),r=t(1413),a=t(20028),o=t(12481),u=t(54174);function d(){var e=(0,o.IO)((0,o.hJ)(u.R,"servicePage")),n=(0,a.sQ)(["servicePage"],e),t=n.data,d=[];null===t||void 0===t||t.forEach((function(e){d.push((0,r.Z)({id:e.id},e.data()))}));var c=function(){var e=(0,i.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.refetch();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Error refetching wedding dress data:",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return{isError:n.isError,isLoading:n.isLoading,data:d,refetch:c}}}}]);
//# sourceMappingURL=2793.d2a28842.chunk.js.map